<html>

<head>
    <title>Настройки</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.9, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/main.css">
    <link rel="stylesheet" type="text/css" href="../css/fonts.css">
    <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../css/animate.css">
    <link rel="stylesheet" type="text/css" href="../css/loading.css">
    <link rel="stylesheet" type="text/css" href="../css/lobibox.min.css" />
    <link rel="stylesheet" type="text/css" href="../css/winter.css">
    <link rel="stylesheet" href="../css/navigationMenu.css">
    <link rel="stylesheet" type="text/css" href="../css/colorpicker.css">
    <style>
        body {
            color: #fff;
            font-family: LatoRegular;
            background: #19212b;
            margin: 0;
        }
        
        .option-block {
            font-size: 1em;
        }
        
        .option-block__name {
            color: #f1ff8a;
            margin-top: 15px;
            display: block;
        }
        
        .option {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 0;
        }
        
        .option>*:nth-child(1) {
            margin-top: 0;
        }
        
        .inline>* {
            display: inline-block;
        }
        
        div#avatar {
            margin-top: 10px;
        }
        
        #avatar img {
            width: 90px;
            height: 90px;
        }
        
        .switch {
            width: 2.67em;
            height: 1.35em;
            background: #e5e5e5;
            z-index: 0;
            margin: 0;
            padding: 0;
            appearance: none;
            border: none;
            cursor: pointer;
            position: relative;
            border-radius: 16px;
            -moz-border-radius: 16px;
            -webkit-border-radius: 16px;
        }
        
        .switch:before {
            content: ' ';
            position: absolute;
            left: 1px;
            top: 1px;
            width: 2.59em;
            height: 1.31em;
            background: #fff;
            z-index: 1;
            border-radius: 16px;
            -moz-border-radius: 16px;
            -webkit-border-radius: 16px;
        }
        
        .switch:after {
            content: ' ';
            height: 1.24em;
            width: 1.24em;
            border-radius: 28px;
            background: #fff;
            position: absolute;
            z-index: 2;
            top: 1px;
            left: 1px;
            -webkit-transition-duration: 300ms;
            transition-duration: 300ms;
            -webkit-box-shadow: 0 2px 5px #999999;
            box-shadow: 0 2px 5px #999999;
        }
        
        .switchOn,
        .switchOn:before {
            background: #4cd964 !important;
        }
        
        .switchOn:after {
            left: 1.36em !important;
        }
        
        .switch-label {
            float: right;
            margin-top: 0;
        }
        
        .lobibox-body-text {
            color: #000;
        }
        
        .film_roll_child.active>img {
            border: 5px solid #F0E50E;
        }
        
        .color_box,
        .add_color {
            width: 50px;
            height: 50px;
            background: #fff;
            border-radius: 5px;
            margin: 3px;
            display: inline-block;
            cursor: pointer;
            position: relative;
        }
        .add_color {
            vertical-align: top;
            text-align: center;
            line-height: 50px;
            color: #7b7b7b;
            font-weight: bold;
            font-size: 2em;
        }
        
        #color_example {
            font-weight: bold;
        }
        .color_box_remove {
            color: #fff;
            text-shadow: 1px 1px 2px #000;
            font-size: 20px;
            font-weight: bold;
            width: 20px;
            height: 18px;
            line-height: 15px;
            padding: 0px;
            text-align: center;
        }

    </style>
</head>

<body data-localization='settings'>
    <div class="site-overlay"></div>
    <div id="container">
        <div class="navigationBar"></div>
        <div class='container'>
            <div id='code' class='input-group' style='display: none;'>
                <input type='text' class='form-control' id='code-input' placeholder='Code...'>
                <div class='input-group-btn'>
                    <button id='code-confirm' class='btn btn-default'>Activate</button>
                </div>
            </div>
            <div class='option-block' data-loc-group="profile"> <span class='option-block__name' data-loc="group_title">Profile</span>
                <div class='option'><span data-loc="nick">Your name</span>
                    <input type="text" id="nickname" class="form-control input-sm" size="20" /> </div>
                <div class='option'><span data-loc="avatar">Avatar</span>
                    <div id="avatar"></div>
                </div>
                <div class="option hidden" id='profile-option'>
                    <div>
                        <span data-loc='email_status'>Email status:</span>
                        <span id='email-status' class='text-danger'>Not verified</span>
                        <p id="relogin-text"><span data-loc='already-verified'>Already verified?</span> <b><a href='#' data-toggle='modal' data-target='#relogin-modal' data-loc='click-here'>Click here</a></b></p>
                    </div>
                    <button class="btn btn-success" id="verify-email" data-loc='verify-email'>Verify email</button>
                    <button class="btn btn-primary" data-loc='change-email' data-toggle='modal' data-target='#change-mail-modal'>Change email</button>
                </div>
            </div>
            <div class='option-block' data-loc-group="beta"> <span class='option-block__name' id='local-beta' data-loc="group_title">Beta</span>
                <div class='option inline'><span data-loc="exchange">Trades</span>
                    <label class='switch-label'>
                        <input type="checkbox" name='trades' class='hide' />
                        <div class='switch' data-target='switch-trades'></div>
                    </label>
                </div>
                <div class='option inline'><span data-loc="trade_notif">Trade notifications</span>
                    <label class='switch-label'>
                        <input type="checkbox" name='trade_notif' class='hide' />
                        <div class='switch' data-target='switch-trade_notif'></div>
                    </label>
                </div>
            </div>
            <div class='option-block' data-loc-group="vip" id='vip_block' style='display:none;'> <span class='option-block__name' data-loc="vip_title">VIP</span>
                <div class='option' id='custom_avatar_opt'><span data-loc="custom_avatar">Custom Avatar (184px x 184px)</span>
                    <input id="custom_avatar" class='form-control input-sm' placeholder="URL"> </div>
                <div class='option' id='nickname_color'><span data-loc="custom_avatar">Nickname color</span>
                    <div>
                        <div class='add_color'>+</div>
                        <div id='color_example'></div>
                    </div>
                </div>
            </div>
            <div class='option-block' data-loc-group="interface"> <span class='option-block__name' data-loc="group_title">Interface</span>
                <div class='option'> <span data-loc="language">Language</span>
                    <div class="dropdown">
                        <select class="form-control input-sm" id="language"></select>
                    </div>
                </div>
                <div class='option inline'> <span data-loc="scroll">Scroll name if it doesn't fit</span>
                    <label class='switch-label'>
                        <input type="checkbox" name='scroll' class='hide' />
                        <div class='switch' data-target='switch-scroll'></div>
                    </label>
                </div>
                <div class='option inline'> <span data-loc="sound">Sound</span>
                    <label class='switch-label'>
                        <input type="checkbox" name='sounds' class='hide' />
                        <div class='switch' data-target='switch-sound'></div>
                    </label>
                </div>
                <div class='option inline'> <span data-loc='fast_drop'>Fast drop (x2)</span>
                    <label class='switch-label'>
                        <input type="checkbox" name='drop' class='hide' />
                        <div class='switch' data-target='switch-drop'></div>
                    </label>
                </div>
            </div>
            <div style='margin: 10px 0; text-align:center'>
                <button class='btn btn-primary' data-loc='promocode' data-toggle='modal' data-target='#modal_promocode'>Activate a promo code</button>
            </div>
            <div style='margin: 10px 0; text-align:center'>
                <button id='submit' class='btn btn-success' data-loc='save'>Save</button>
                <button id='reset' class='btn btn-danger' data-loc='reset'>Full reset</button>
            </div>
        </div>

        <div id='modal_promocode' class='modal fade' role="dialog">
            <div class="modal-dialog">
                <div class="modal-content" data-loc-group='promo_modal'>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="promocode" data-loc='enter'>Enter promocode:</label>
                            <input type="text" class='form-control' id='promocode'>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-success" id='activate_promocode' data-loc='activate'>Activate</button>
                        <button class="btn btn-default" data-dismiss='modal' data-loc='close'>Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div id='change-mail-modal' class='modal fade' role="dialog">
            <div class="modal-dialog">
                <div class="modal-content" data-loc-group='change_mail_modal'>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="password" data-loc='password'>Password:</label>
                            <input type="password" class='form-control' id='password'>
                            <label for="mail" data-loc='new'>New email address:</label>
                            <input type="email" class='form-control' id='mail'>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-success" id='change-mail' data-loc='change'>Change</button>
                        <button class="btn btn-default" data-dismiss='modal' data-loc='close'>Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div id='relogin-modal' class='modal fade' role="dialog">
            <div class="modal-dialog">
                <div class="modal-content" data-loc-group='change_mail_modal'>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="password2" data-loc='password'>Password:</label>
                            <input type="password" class='form-control' id='password2'>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-success" id='relogin'>OK</button>
                        <button class="btn btn-default" data-dismiss='modal' data-loc='close'>Close</button>
                    </div>
                </div>
            </div>
        </div>

        <script src="../scripts/build/libs.js"></script>
        <script src="../scripts/bootstrap.min.js"></script>
        <script src="../scripts/main.js"></script>
        <script src="../scripts/settings.js"></script>
        <script src="../scripts/weapons.js"></script>
        <script src="../scripts/skinNames.js"></script>
        <script src="../scripts/prices.js"></script>
        <script src="../scripts/jackpotBots.js"></script>
        <script src="../scripts/navigationMenu.js"></script>
        <script src="../scripts/localization.js"></script>
        <script src="../scripts/settings/colorpicker.js"></script>
        <script src="https://www.promisejs.org/polyfills/promise-7.0.4.min.js"></script>
        <script>
            $(function() {

                /* Languages */
                for (var i = 0; i < Localization.supportedLanguages.names.full.length; i++) {
                    $('#language').append('<option value="' + Localization.supportedLanguages.names.short[i] + '">' + Localization.supportedLanguages.names.full[i] + '</option>')
                }

                /*Ava*/
                var i = Bot.images.length;
                var html = "";
                while (i--) {
                    html += "<div data-img='" + Bot.images[i] + "'><img src='" + avatarUrl(Bot.images[i]) + "'></div>"
                }
                $("#avatar").html(html);
                fn = new FilmRoll({
                    container: '#avatar',
                    pager: false,
                    scroll: false,
                    start_index: $("#avatar div[data-img='" + Player.avatar + "']").index()
                });

                $('#custom_avatar').val(Player.avatar);
                var correctImg = false;

                $("#nickname").val(Player.nickname);

                $('select option[value=' + Settings.language + ']').attr('selected', 'true');
                if (Settings.sounds == true) {
                    $('input[name="sounds"]').prop('checked', true);
                    $('.switch[data-target="switch-sound"]').addClass('switchOn');
                }
                if (Settings.drop == true) {
                    $('input[name="drop"]').prop('checked', true);
                    $('.switch[data-target="switch-drop"]').addClass('switchOn');
                }
                if (Settings.scroll_names == true) {
                    $('input[name="scroll"]').prop('checked', true);
                    $('.switch[data-target="switch-scroll"]').addClass('switchOn');
                }

                Player.isVip = false;

                firebase.auth().onAuthStateChanged(function(user) {
                    if (firebase.auth().currentUser != null) {
                        $('#profile-option').removeClass('hidden');
                        
                        var user = firebase.auth().currentUser;
                        
                        // If email is verified
                        if (user.emailVerified) {
                            $('#verify-email').hide();
                            $('#relogin-text').hide();
                            if (Localization.isLoaded) {
                                changeEmailStatus();
                            }
                        }

                        var uid = user.uid;
                        firebase.database().ref('users/' + uid + '/public/betaTrade').once('value', function(data) {
                            if (data.val() == true) {
                                $('input[name="trade"]').prop('checked', true);
                                $('.switch[data-target="switch-trades"]').addClass('switchOn');
                            } else {
                                $('input[name="trades"]').prop('checked', false);
                            }
                        })
                        firebase.database().ref('users/' + uid + '/private/tradeNotification').once('value', function(data) {
                            if (data.val() == false) {
                                $('input[name="trade_notif"]').prop('checked', false);
                            } else {
                                $('input[name="trade_notif"]').prop('checked', true);
                                $('.switch[data-target="switch-trade_notif"]').addClass('switchOn');
                            }
                        })

                        // if User is VIP.
                        firebase.database().ref('users/' + uid + '/moder/group').once('value', function(data) {
                            var group = data.val();
                            if (group && group.match(/(vip|admin|donor)/)) {
                                $('#vip_block').show();
                                Player.isVip = true;

                                // Load user nickname color
                                firebase.database().ref('users/' + uid + '/vip/nicknameColor').once('value', function(data) {
                                    var colors = data.val(); // String
                                    if (!colors) return;
                                    colors = colors.split(','); // Array
                                    for (var i = 0; i < colors.length; i++) {
                                        $('.add_color').click();
                                    }
                                    for (var i = 0; i < colors.length; i++) {
                                        var $el = $('.color_box:eq(' + i + ')');
                                        $el.css('background-color', colors[i]);
                                        $el.data('color', colors[i]);

                                        $el.ColorPickerSetColor(colors[i]);
                                    }
                                    nicknameColorChange();
                                })
                            }
                        })
                    }
                })

                $('#activate_promocode').on('click', function() {
                    var promocode = $('#promocode').val();
                    if (promocode.length < 3) return;

                    var extra = JSON.parse(getStatistic('extra', '{}'));
                    if (extra.promocodes && extra.promocodes[promocode] != null) {
                        $.notify({
                            message: _t('other.promocode.used', 'You already used this code.')
                        }, {
                            type: 'danger'
                        })
                        $('#modal_promocode').modal('hide');
                        return;
                    }

                    $(this).addClass('m-progress');

                    $.ajax({
                        //url: 'http://localhost:3000/api/promocode?code=' + promocode,
                        url: 'https://kvmde40-10035.fornex.org/api/promocode?code=' + promocode,
                        jsonp: 'callback',
                        dataType: 'jsonp',
                        success: function(response) {
                            $('#modal_promocode').modal('hide');
                            $('#activate_promocode').removeClass('m-progress');

                            if (response != null) {
                                if (response.action) {
                                    eval(response.action);
                                }
                                if (response.comment) {
                                    $.notify({
                                        message: response.comment
                                    }, {
                                        type: 'success'
                                    })
                                }
                                if (!extra.promocodes) extra.promocodes = {};
                                extra.promocodes[promocode] = true;
                                saveStatistic('extra', extra);

                                LOG.log({
                                    action: 'Activate promo code',
                                    code: promocode
                                })
                            } else {
                                $.notify({
                                    message: _t('other.promocode.wrong', 'Wrong promo code.')
                                }, {
                                    type: 'danger'
                                })
                            }
                        }
                    })
                })
                
                // Verify email
                $(document).on('click', '#verify-email', function() {
                    firebase.auth().currentUser.sendEmailVerification().then(function() {
                        $.notify({
                            message: _t('settings.email-sent', 'Check your email')
                        }, {
                            type: 'success'
                        })
                        
                        LOG.log({
                            action: 'Send verification mail'
                        })
                    }, function (error) {
                        $.noticy({
                            message: error.message
                        }, {
                            type: 'danger'
                        })
                        console.log(error);
                    })
                })
                
                $(document).on('click', '#relogin', function() {
                    $(this).addClass('m-progress');
                    var pass = $('#password2').val();
                    
                    var user = firebase.auth().currentUser;
                    var credential = firebase.auth.EmailAuthProvider.credential(
                        user.email,
                        pass
                    )
                    
                    user.reauthenticate(credential).then(function() {
                        if (firebase.auth().currentUser.emailVerified) {
                            $('#relogin-text').hide();
                            $('#verify-email').hide();
                            $('#email-status').text(_t('settings.profile.email_verified', 'Verified')).removeClass('text-danger').addClass('text-success');
                            
                            LOG.log({
                                action: 'Email virified'
                            })
                        }
                        $('#relogin-modal').modal('hide');
                        $('#relogin').removeClass('m-progress');
                    }, function(error) {
                        $.notify({
                            message: error.message
                        }, {
                            type: 'danger'
                        })
                    })
                })
                
                // Change email
                $(document).on('click', '#change-mail', function() {
                    $(this).addClass('m-progress');
                    var pass = $('#password').val();
                    
                    var user = firebase.auth().currentUser;
                    var credential = firebase.auth.EmailAuthProvider.credential(
                        user.email,
                        pass
                    )
                    
                    var newMail = $('#mail').val();
                    if (!/.*@.*\..{1,5}$/.test(newMail)) {
                        $.notify({
                            message: 'Wrong email'
                        }, {
                            type: 'danger'
                        });
                        return
                    }
                    
                    user.reauthenticate(credential).then(function() {
                        firebase.auth().currentUser.updateEmail(newMail).then(function() {
                            $.notify({
                                message: 'OK!'
                            }, {
                                type: 'success'
                            })
                            $('#change-mail-modal').modal('hide');
                            $('#change-mail').removeClass('m-progress');
                        }, function(error) {
                            $.notify({
                                message: error.message
                            }, {
                                type: 'danger'
                            })
                            console.log(error);

                            $('#change-mail-modal').modal('hide');
                            $('#change-mail').removeClass('m-progress');

                            LOG.err({
                                action: 'Error on email changing',
                                error: error
                            })
                        })
                        
                    }, function(error) {
                        $.notify({
                            message: 'Wrong password'
                        }, {
                            type: 'danger'
                        })
                    })            
                })
            });

            $('.add_color').on('click', function() {

                $('<div class="color_box" data-color="#ffffff"><div class="color_box_remove">&times;</div></div>').insertBefore('.add_color');

                $('.color_box').each(function() {
                    var that = this;
                    $(that).ColorPicker({
                        onChange: function(hsb, hex, rgb) {
                            $(that).css('background', '#' + hex);
                            $(that).data('color', '#' + hex);
                            nicknameColorChange();
                        }
                    })
                })

                if ($('.color_box').length == 4)
                    $('.add_color').hide();
            })

            $(document).on('click', '.color_box_remove', function(e) {
                $(this).parent().remove();
                nicknameColorChange();
                $('.add_color').show();
                e.preventDefault();
                e.stopPropagation();
            })

            function nicknameColorChange() {
                var nickname = $('#nickname').val();
                $('#color_example').html(nickname);

                var colors = [];
                $('.color_box').each(function() {
                    colors.push($(this).data('color'));
                })

                $('#color_example').gradientText({
                    colors: colors
                });
            }
            $('#custom_avatar').change(function() {
                getMeta($(this).val(), function(size) {
                    if (size && size.width != size.heigth && size.width != 184) {
                        Lobibox.notify('error', {
                            pauseDelayOnHover: false,
                            continueDelayOnInactiveTab: false,
                            width: $(window).width(),
                            position: 'top center',
                            icon: false,
                            title: 'Image size',
                            delay: 4000,
                            size: 'mini',
                            showClass: 'fadeInDown',
                            hideClass: 'fadeOutUp',
                            msg: 'Image must be 184px x 184px'
                        });
                        correctImg = false;
                    } else {
                        correctImg = true;
                    }
                })
            })
            $(document).on('localizationloaded', function() {
                $('#translator').text(Translation.info.author);
                $('#translation_date').text(Translation.info.date);
                
                if (firebase.auth().currentUser) {
                    changeEmailStatus();
                }
            })
            $("#submit").on("click", function() {
                var nick = $("#nickname").val();
                var validation = /^[a-zA-Zа-яёА-ЯЁ0-9_-]+$/;
                var illicitNick = /((a|а|о|o)(d|д)(m|м)(i|\||и|n)(n|и|н)|(VL(A|а)D(O|о)(S|c|с)(?:776)?))/ig;
                if (nick != "" && validation.test(nick) && !illicitNick.test(nick)) {
                    saveStatistic("playerNickname", nick)
                    Player.nickname = nick;
                } else {
                    $.notify({
                        message: _t('settings.notification.invalid_nick')
                    }, {
                        type: 'danger'
                    })
                    return false;
                }
                var lang = $('#language option:selected').val();
                if (Settings.language != lang) Localization.changeLanguage(lang);
                Settings.language = lang;
                Settings.sounds = $('input[name="sounds"]').prop('checked');
                Settings.drop = $('input[name="drop"]').prop('checked');
                Settings.scroll_names = $('input[name="scroll"]').prop('checked');

                saveStatistic('settings_language', Settings.language);
                saveStatistic('settings_scroll', Settings.scroll_names);
                saveStatistic('settings_sounds', Settings.sounds);
                saveStatistic('settings_drop', Settings.drop);
                try {
                    var avatar = $('.film_roll_child.active img').attr('src').match(/\/[0-9a-z-_]+\.\w{3}$/i)[0].replace('/', '');
                } catch (e) {
                    var avatar = '0.jpg';
                }
                var customAvatar = $('#custom_avatar').val();
                if (customAvatar !== '' && /^(http|www).*?\.(png|jpg|jpeg|gif)$/.test(customAvatar)) {
                    avatar = XSSreplace(customAvatar);
                }
                saveStatistic("playerAvatar", avatar);
                Player.avatar = avatar;
                $('.menu_ava').attr('src', avatarUrl(avatar));
                Settings.language = lang;
                try {
                    var userRef = firebase.database().ref('users/' + firebase.auth().currentUser.uid);
                    userRef.child('/public/betaTrade').set($('input[name="trades"]').prop('checked'));
                    userRef.child('/private/tradeNotification').set($('input[name="trade_notif"]').prop('checked'));
                    userRef.child('/public/avatar').set(avatarUrl(avatar));
                    userRef.child('/public/nickname').set(XSSreplace(Player.nickname));
                    userRef.child('/settings/language').set(Settings.language);
                    userRef.child('/settings/drop').set(Settings.drop);
                    userRef.child('/settings/sounds').set(Settings.sounds);

                    if (Player.isVip) {
                        var colors = [];
                        $('.color_box').each(function() {
                            colors.push($(this).data('color'));
                        })
                        userRef.child('/vip/nicknameColor').set(colors.join(','));
                    }
                } catch (e) {
                    console.log(e);
                }
                LOG.log({
                    action: 'Change settings'
                })
                $.notify({
                    message: _t('settings.notification.saved', 'Saved')
                }, {
                    type: 'success'
                })
            });
            $('#reset').on('click', function() {
                Lobibox.confirm({
                    iconSource: 'fontAwesome',
                    title: _t('settings.notification.reset_confirm_title'),
                    msg: _t('settings.notification.reset_confirm'),
                    callback: function($tihs, type, ev) {
                        if (type == 'yes') {
                            if (isAndroid()) {
                                client.deleteAllInventory();
                            } else {
                                localStorage.clear();
                                window.indexedDB.deleteDatabase('Inventory');
                            }
                            deleteAllCookies();
                            saveStatistic('doubleBalance', 0);
                            saveStatistic('playerPoints', 0);
                            $.notify({
                                message: _t('settings.notification.reset_done')
                            }, {
                                type: 'success'
                            })
                            try {
                                var userRef = firebase.database().ref('users/' + firebase.auth().currentUser.uid);
                                userRef.child('/settings/drop').set(false);
                                userRef.child('/settings/sounds').set(true);
                                userRef.child('/private/double').set(0);
                                userRef.child('/public/points').set(0);
                            } catch (e) {
                                console.log(e);
                            }
                        }
                    }
                });
            })
            $('.switch').click(function() {
                $(this).toggleClass("switchOn");
            });

            function changeEmailStatus() {
                if (firebase.auth().currentUser.emailVerified) {
                    $('#email-status').text(_t('settings.profile.email_verified', 'Verified')).removeClass('text-danger').addClass('text-success');
                } else {
                    $('#email-status').text(_t('settings.profile.email_not_verified', 'Not verified'));
                }
            }

            function deleteAllCookies() {
                var cookies = document.cookie.split(";");
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i];
                    var eqPos = cookie.indexOf("=");
                    var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                    document.cookie = name + "=;";
                }
            }
            $(document).on('click', '[data-loc-group="interface"] .option-block__name[data-loc="group_title"]', function() {
                $('#code').toggle();
            })
            $(document).on('click', '#code-confirm', function() {
                var codesList = [{
                    simpleCode: 'localServer',
                    code: '',
                    multiply: true,
                    action: 'location="http://192.168.1.205:8080"',
                    description: 'Go to local web server.'
                }, {
                    simpleCode: 'Splash',
                    code: '',
                    multiply: true,
                    action: 'client.showSplashScreen();',
                    description: 'Go to local web server.'
                }, {
                    simpleCode: 'Upgrader',
                    code: '',
                    multiply: true,
                    action: 'location="https://vlados776.github.io/OpenCase_Beta2/RUS/upgrader.html";',
                    description: 'Fus ro dah'
                }];
                var code = $('#code-input').val();
                if (code == "") {
                    $("#code-input").addClass("animated shake");
                    setTimeout(function() {
                        $("#code-input").removeClass("animated shake");
                    }, 1000);
                    return false
                }
                codeHex = hex_md5(code);
                var msg = "";
                for (var i = 0; i < codesList.length; i++)
                    if (codesList[i].code == codeHex || (typeof codesList[i].simpleCode != "undefined" && codesList[i].simpleCode == code))
                        if (getStatistic('code-' + code, 'none') == 'none' || codesList[i].multiply) {
                            eval(codesList[i].action);
                            saveStatistic('code-' + code, 'activated');
                            msg = codesList[i].description;
                        }
                else {
                    msg = 'Code already activated.';
                }
                Lobibox.notify('info', {
                    pauseDelayOnHover: false,
                    continueDelayOnInactiveTab: false,
                    width: $(window).width(),
                    position: 'top center',
                    icon: false,
                    title: "Code activation",
                    delay: 2000,
                    size: 'mini',
                    showClass: 'fadeInDown',
                    hideClass: 'fadeOutUp',
                    msg: msg
                });
            })

            function getMeta(url, callback) {
                $("<img/>", {
                    load: function() {
                        callback({
                            width: this.width,
                            height: this.height
                        });
                    },
                    src: url
                });
            }

        </script>
        <script src="../scripts/jquery.film_roll.min.js"></script>
        <script src="../scripts/jquery.touchSwipe.min.js"></script>
</body>

</html>
